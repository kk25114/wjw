# 数仓脚本说明文档

## 目录结构
```
3.数仓脚本/
├── 01-10/          # 2001-2010年数据处理脚本
├── 11-21/          # 2011-2021年数据处理脚本
└── 22-23/          # 2022-2023年数据处理脚本
```

## 功能说明

### 主要功能
- 处理卫生考试（卫考）和护理考试（护考）的历史数据
- 支持数据从Oracle数据库到Hive的ETL过程
- 按年份分批处理数据，支持单独年份的数据更新

### 脚本说明

#### 主要脚本
1. `main.sh`
   - 位于各年份目录下
   - 负责调用ETL处理脚本
   - 支持卫考和护考数据的批量处理
   - 包含数据库连接配置和年份参数

2. `action/etl_sh_new.sh`
   - 核心ETL处理脚本
   - 执行具体的数据抽取和加载任务

3. `action/update_*_by_partition.sh`
   - 分区数据更新脚本
   - 支持特定表的增量更新

4. `action/hql-create-table.sql`
   - Hive表结构定义文件
   - 包含目标表的建表语句

### 使用说明

1. 数据库配置
   - 源数据库：Oracle
   - 目标数据库：Hive
   - 配置参数在main.sh中以JSON格式提供

2. 执行方式
   ```bash
   # 进入对应年份目录
   cd 01-10/  # 或 11-21/ 或 22-23/
   
   # 执行主脚本
   bash main.sh
   ```

3. 日志管理
   - 执行日志保存在 `log/` 目录
   - 按年份和考试类型分别记录

### 注意事项
1. 执行脚本前请确认数据库连接参数的正确性
2. 建议按年份顺序执行数据处理
3. 每个批次执行完成后检查日志确认是否成功
4. 数据更新时注意检查分区信息

## 维护记录
- 初始版本：2024-01-21
